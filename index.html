<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloudflare Worker 翻译代理客户端</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="bg-white rounded-xl shadow-lg p-8 w-full max-w-2xl">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Cloudflare Worker 翻译代理客户端</h1>
        <div class="mb-4">
            <label for="inputText" class="block text-gray-700 text-sm font-medium mb-2">输入要翻译的文本:</label>
            <textarea id="inputText" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" rows="6" placeholder="例如：Hello world!"></textarea>
        </div>
        
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 space-y-4 md:space-y-0 md:space-x-4">
            <div class="w-full md:w-1/2">
                <label for="fromLang" class="block text-gray-700 text-sm font-medium mb-2">源语言:</label>
                <select id="fromLang" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                    <option value="auto">自动检测</option>
                    <option value="en">英语</option>
                    <option value="zh-CN" selected>中文 (简体)</option>
                    <option value="fr">法语</option>
                    <option value="es">西班牙语</option>
                    <option value="ja">日语</option>
                    <option value="ko">韩语</option>
                </select>
            </div>
            <div class="w-full md:w-1/2">
                <label for="toLang" class="block text-gray-700 text-sm font-medium mb-2">目标语言:</label>
                <select id="toLang" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                    <option value="zh-CN" selected>中文 (简体)</option>
                    <option value="en">英语</option>
                    <option value="fr">法语</option>
                    <option value="es">西班牙语</option>
                    <option value="ja">日语</option>
                    <option value="ko">韩语</option>
                </select>
            </div>
        </div>
        
        <button onclick="translateText()" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 shadow-md">
            翻译
        </button>
        
        <div class="mt-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-3">翻译结果:</h2>
            <div id="result" class="bg-gray-50 border border-gray-300 rounded-lg p-4 min-h-[80px] flex items-center justify-center text-gray-700 text-base break-words overflow-wrap">
                等待翻译...
            </div>
        </div>
    </div>

    <script>
        // 这是您的 Cloudflare Worker 的基础 URL
        const WORKER_BASE_URL = 'https://google-translate-proxy.abc15018045126.workers.dev';

        /**
         * 异步函数，用于发送翻译请求到 Cloudflare Worker 并显示结果。
         */
        async function translateText() {
            const inputText = document.getElementById('inputText').value;
            const fromLang = document.getElementById('fromLang').value;
            const toLang = document.getElementById('toLang').value;
            const resultDiv = document.getElementById('result');

            if (!inputText.trim()) {
                resultDiv.textContent = "请输入文本进行翻译。";
                resultDiv.classList.add('text-red-600');
                return;
            } else {
                resultDiv.classList.remove('text-red-600');
            }

            resultDiv.textContent = "翻译中...";
            resultDiv.classList.add('text-gray-500');

            try {
                // 构建符合 Google Translate API 原始风格的路径和查询字符串
                const encodedText = encodeURIComponent(inputText);
                const encodedFromLang = encodeURIComponent(fromLang);
                const encodedToLang = encodeURIComponent(toLang);

                // 构造 Google Translate API 风格的完整路径和查询字符串
                const apiPathAndQuery = `/translate_a/single?client=gtx&sl=${encodedFromLang}&tl=${encodedToLang}&dt=t&q=${encodedText}`;
                
                // 将 Worker 的基础 URL 和 API 路径拼接起来
                const fullWorkerUrl = WORKER_BASE_URL + apiPathAndQuery;

                // 发送 fetch 请求到 Cloudflare Worker
                const response = await fetch(fullWorkerUrl);
                
                if (response.ok) {
                    const translatedContent = await response.text();
                    resultDiv.textContent = translatedContent;
                    resultDiv.classList.remove('text-gray-500');
                    resultDiv.classList.add('text-green-700');
                } else {
                    const errorText = await response.text();
                    resultDiv.textContent = `翻译失败: ${errorText}`;
                    resultDiv.classList.remove('text-gray-500');
                    resultDiv.classList.add('text-red-600');
                    console.error('Translation API error:', response.status, errorText);
                }
            } catch (error) {
                resultDiv.textContent = `请求出错: ${error.message}`;
                resultDiv.classList.remove('text-gray-500');
                resultDiv.classList.add('text-red-600');
                console.error('Fetch error:', error);
            }
        }
    </script>
</body>
</html>
